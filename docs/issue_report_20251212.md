# RAG 정확성 문제 분석 보고서 (2025-12-12)

## 1. 개요
2025년 12월 12일 수행된 수동 테스트 중, 기본적인 EC2 인스턴스 생성 질문에 대해 RAG 시스템이 심각한 정확성 문제를 보였습니다. 본 문서는 해당 문제의 상세 내용과 원인을 기록합니다.

## 2. 문제 상세

### 2.1 테스트 케이스
- **질문**: "EC2에서 서버생성하는 법을 알려줘"
- **기대 답변**: EC2 콘솔 또는 CLI(`run-instances`)를 사용하여 인스턴스를 시작하는 방법 안내 (참조: EC2 User Guide).

### 2.2 검색 실패 (Retrieval Failure)
RAG 시스템이 검색한 상위 문서(Chunks)는 다음과 같으며, 질문과 직접적인 관련이 낮았습니다.
1. **Amazon VPC 시작하기 (SDK)**: `Waiters`, `VpcWrapper` 등 Python/Ruby SDK 코드 예제.
2. **App Mesh**: `DeleteVirtualNode` 등 라우팅 관련 CLI 참조.
3. **Transit Gateway**: 네트워크 연결 설정 가이드.

* **원인 추정**:
    * 사용자의 질문 키워드("서버", "생성")가 포함된 기술 문서들이 많아 BM25/Vector 검색이 "EC2 인스턴스 생성"이라는 구체적 의도보다 "코드 예제"나 "설정" 문서를 더 높게 평가했을 가능성.
    * 핵심 문서(EC2 User Guide의 `RunInstances` 섹션)가 인덱스에 없거나 순위에서 밀려남.

### 2.3 환각 현상 (Hallucination)
검색된 문서에 정답이 없자, LLM(Local/OpenAI)은 다음과 같이 잘못된 정보를 생성했습니다.

- **잘못된 답변**: "새로운 서버를 생성하는 방법은 **AWS GameLift**를 사용하여..."
- **분석**:
    * 검색된 컨텍스트(Context)에 정답이 부재한 상황에서, 모델이 "서버 생성"이라는 키워드에 반응하여 학습된 데이터 중 엉뚱한(GameLift) 지식을 인출함.
    * 'AWS 기술 어시스턴트'라는 페르소나와 맞물려 그럴듯해 보이지만 완전히 틀린 답변을 제공.

## 3. 개선 방향 (Action Items)

1. **인덱스 데이터 검증**: `EC2 User Guide` 등 핵심 문서가 누락되지 않았는지 확인.
2. **청킹(Chunking) 전략 개선**: 불필요한 SDK/API 레퍼런스 코드 블록이 검색을 방해하지 않도록 메타데이터 필터링이나 청크 크기 조절.
3. **검색 품질 튜닝**:
    * **Hybrid Search 가중치 조절**: 키워드(BM25) vs 의미(Vector) 비중 재조정.
    * **Reranker 도입/개선**: 1차 검색된 결과 중 질문 의도와 가장 부합하는 문서를 상위로 올리는 재순위화 로직 강화.
4. **부정확한 응답 방지(Guardrails)**: 검색 결과의 유사도 점수가 낮을 경우 "답변할 수 없음" 또는 "일반적인 지식으로 답변함"을 명시하도록 프롬프트 수정.
